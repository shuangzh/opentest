package cmsz.rd.optentest.filetest;

import cmsz.rd.opentest.file.creator.Creator;
import cmsz.rd.opentest.file.creator.FieldConf;
import cmsz.rd.opentest.file.creator.GEN;
import cmsz.rd.opentest.file.creator.LineConf;
import com.thoughtworks.xstream.XStream;
import org.junit.Test;

import java.util.ArrayList;

/**
 * Created by admin on 2017/4/14.
 */
public class FileTest {

    @Test
    public void fileGenTest()
    {
        Creator creator= new Creator();
        LineConf lineConf=new LineConf();
        lineConf.setFs("|");
        lineConf.setStyle("sep");

        lineConf.setFields(new ArrayList<FieldConf>());
        FieldConf fieldConf= new FieldConf();
        fieldConf.setName("id");
        fieldConf.setFormat("%10s");
        fieldConf.setValue("123456789");
        fieldConf.setGen(GEN.NUMBER_INCR);

        lineConf.getFields().add(fieldConf);
        fieldConf= (FieldConf) fieldConf.clone();
        fieldConf.setName("name");
        fieldConf.setFormat("%-8s");
        fieldConf.setValue("000111");
        fieldConf.setGen(GEN.REPEATE);

        lineConf.getFields().add(fieldConf);

        String s = lineConf.assemble();
        System.out.println(s);

        creator.setLineConf(lineConf);

        creator.xmlLineConf("<line>\n" +
                "  <fields>\n" +
                "    <field>\n" +
                "      <name>id</name>\n" +
                "      <format>%10s</format>\n" +
                "      <value>123456700</value>\n" +
                "      <gen>number_incr</gen>\n" +
                "    </field>\n" +
                "    <field>\n" +
                "      <name>name</name>\n" +
                "      <format>%-8s</format>\n" +
                "      <value>000111</value>\n" +
                "      <gen>repeat</gen>\n" +
                "    </field>\n" +
                "  </fields>\n" +
                "  <style>sep</style>\n" +
                "  <fs>**</fs>\n" +
                "</line>");



        creator.append(10);
        creator.print();

        System.out.println("********************************************************");


        creator.setLineConf(lineConf);
        creator.append(5);
        lineConf.addFieldConf(new String[]{"value2", "%5s", "54321"});
        creator.append(20);
        creator.print();

        XStream xs=new XStream();
        xs.setMode(XStream.NO_REFERENCES);
        xs.processAnnotations(new Class[]{LineConf.class, FieldConf.class});
        String xml=xs.toXML(lineConf);
        System.out.println(xml);




    }
}
