package cmsz.rd.opentest.cmd;

import java.io.File;
import java.io.IOException;

/**
 * Created by admin on 2017/4/12.
 */

/**
 * 进程控制接口
 *
 */
public interface CmdProcess {

    /**
     * 获取进程名字
     * @return
     */
    String getProcessName();

    /**
     * 使用 Runtime.exec 启动进程
     * @throws IOException
     */
    void start() ;

    /**
     * 将进程的输出写入文件
     * @return
     */
    File getStdoutFile();

    /**
     * 获取输出的最后一行
     * @return
     */
    String getLastStdoutLine();

    /**
     * 等待process结束，并返回进程返回值
     * @return
     */
    Integer waitFor();

    /**
     * 判断process是否还存活
     * @return
     */
    boolean isAlive();

    /**
     * 获取进程返回值
     * @return
     */
    Integer exitValue();

    /**
     * 销毁process
     */
    void destroy();

    /**
     * 返回命令行
     * @return
     */
    String getCmdLine();

    /**
     * 添加输出错误检查器
     * @param checker
     */
    void addChecker(Checker checker);

    /**
     * 注册Blocker
     * @param blocker
     */
    void registerBlocker(Blocker blocker);

    /**
     * 检查所有的checker，如果有错误抛出异常
     */
    void detectCheckers();

    /**
     * 检查Blocker是否已满足条件，如果满足，则进行执行，如果不满足，则阻塞
     */
    void joinBlocker();

    /**
     * 检查Blocker是否已满足条件,如果不满足，并且超过timeout时间，则抛出异常
     * @param timeout
     */
    void joinBlocker(double timeout);

}
